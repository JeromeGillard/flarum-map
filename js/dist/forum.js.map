{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@jeromegillard/map/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@jeromegillard/map/./node_modules/@babel/runtime/helpers/typeof.js","webpack://@jeromegillard/map/./node_modules/@babel/runtime/regenerator/index.js","webpack://@jeromegillard/map/webpack/bootstrap","webpack://@jeromegillard/map/webpack/runtime/compat get default export","webpack://@jeromegillard/map/webpack/runtime/define property getters","webpack://@jeromegillard/map/webpack/runtime/hasOwnProperty shorthand","webpack://@jeromegillard/map/webpack/runtime/make namespace object","webpack://@jeromegillard/map/external root \"flarum.core.compat['common/app']\"","webpack://@jeromegillard/map/./src/common/index.ts","webpack://@jeromegillard/map/external root \"flarum.core.compat['forum/app']\"","webpack://@jeromegillard/map/external root \"flarum.core.compat['components/Post']\"","webpack://@jeromegillard/map/external root \"flarum.core.compat['components/Page']\"","webpack://@jeromegillard/map/external root \"flarum.core.compat['common/extend']\"","webpack://@jeromegillard/map/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@jeromegillard/map/external root \"flarum.core.compat['common/components/TextEditorButton']\"","webpack://@jeromegillard/map/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@jeromegillard/map/external root \"flarum.core.compat['common/Model']\"","webpack://@jeromegillard/map/external root \"flarum.core.compat['common/utils/mixin']\"","webpack://@jeromegillard/map/./src/forum/components/mapFile.js","webpack://@jeromegillard/map/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@jeromegillard/map/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@jeromegillard/map/./src/forum/components/mapConfigHelper.js","webpack://@jeromegillard/map/./src/forum/index.js","webpack://@jeromegillard/map/./src/forum/components/mapBBCode.js"],"sourcesContent":["var _typeof = require(\"./typeof.js\")[\"default\"];\n\nfunction _regeneratorRuntime() {\n  \"use strict\";\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var exports = {},\n      Op = Object.prototype,\n      hasOwn = Op.hasOwnProperty,\n      $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n      iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n      asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n      toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n        generator = Object.create(protoGenerator.prototype),\n        context = new Context(tryLocsList || []);\n    return generator._invoke = function (innerFn, self, context) {\n      var state = \"suspendedStart\";\n      return function (method, arg) {\n        if (\"executing\" === state) throw new Error(\"Generator is already running\");\n\n        if (\"completed\" === state) {\n          if (\"throw\" === method) throw arg;\n          return doneResult();\n        }\n\n        for (context.method = method, context.arg = arg;;) {\n          var delegate = context.delegate;\n\n          if (delegate) {\n            var delegateResult = maybeInvokeDelegate(delegate, context);\n\n            if (delegateResult) {\n              if (delegateResult === ContinueSentinel) continue;\n              return delegateResult;\n            }\n          }\n\n          if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n            if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n            context.dispatchException(context.arg);\n          } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n          state = \"executing\";\n          var record = tryCatch(innerFn, self, context);\n\n          if (\"normal\" === record.type) {\n            if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n            return {\n              value: record.arg,\n              done: context.done\n            };\n          }\n\n          \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n        }\n      };\n    }(innerFn, self, context), generator;\n  }\n\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n\n  function Generator() {}\n\n  function GeneratorFunction() {}\n\n  function GeneratorFunctionPrototype() {}\n\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n      NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n            value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n\n      reject(record.arg);\n    }\n\n    var previousPromise;\n\n    this._invoke = function (method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function (resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n    };\n  }\n\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n\n    if (undefined === method) {\n      if (context.delegate = null, \"throw\" === context.method) {\n        if (delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel;\n        context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n            next = function next() {\n          for (; ++i < iterable.length;) {\n            if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n          }\n\n          return next.value = undefined, next.done = !0, next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    return {\n      next: doneResult\n    };\n  }\n\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, define(Gp, \"constructor\", GeneratorFunctionPrototype), define(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (object) {\n    var keys = [];\n\n    for (var key in object) {\n      keys.push(key);\n    }\n\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) {\n        \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n      }\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n            record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n              hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n\n          return thrown;\n        }\n      }\n\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\n\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\n\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\n\napp.initializers.add('jeromegillard/osm', () => {\n  console.log('[jeromegillard/osm] Hello, forum and admin!');\n});\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditor'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditorButton'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/mixin'];","import Model from 'flarum/common/Model';\nimport mixin from 'flarum/common/utils/mixin';\n\nexport default class mapFile extends mixin(Model, {\n    baseName: Model.attribute('baseName'),\n    path: Model.attribute('path'),\n    url: Model.attribute('url'),\n    type: Model.attribute('type'),\n    size: Model.attribute('size'),\n    humanSize: Model.attribute('humanSize'),\n    createdAt: Model.attribute('createdAt'),\n    uuid: Model.attribute('uuid'),\n    tag: Model.attribute('tag'),\n    hidden: Model.attribute('hidden')\n}){\n\n\n    /**\n     * Use FoF Uploads endpoint\n     */\n    apiEndpoint() {\n        return '/fof/uploads' + (this.exists ? '/' + this.data.id : '');\n    }\n\n    /**\n     * Generate bbcode for this file\n     */\n    bbcode() {\n        //console.log('checking', this.tag())\n        switch (this.tag()) {\n            case 'jeromegillard-map':\n                return `[upl-file uuid=${this.uuid()} size=${this.humanSize()} url=${this.url()}]${this.baseName()}[/upl-file]`;\n            // File\n            case 'file':\n                return `[upl-file uuid=${this.uuid()} size=${this.humanSize()}]${this.baseName()}[/upl-this]`;\n\n            // Image template\n            case 'image':\n                return `[upl-image uuid=${this.uuid()} size=${this.humanSize()} url=${this.url()}]${this.baseName()}[/upl-image]`;\n\n            // Image preview\n            case 'image-preview':\n                return `[upl-image-preview url=${this.url()}]`;\n\n            // 'just-url' or unknown\n            default:\n                return this.url();\n        }\n            \n    }\n\n\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import app from 'flarum/forum/app';\n\nexport function getMapConfig(o_tilesProvider, o_style, o_zoom) {\n    let tilesProvider = app.forum.attribute(\"tilesProvider\")||'osm';\n    let currentStyle;\n    let currentKey;\n    let tileLayerURL;\n    let zoom = app.forum.attribute(\"zoom\")||13;\n    let attribution;\n    let type = 'raster';\n\n    if(o_tilesProvider &&\n        o_tilesProvider === 'mapbox' ||\n        o_tilesProvider === 'thunderforest' ||\n        o_tilesProvider === 'osm') {\n            tilesProvider = o_tilesProvider;\n    }\n\n    if(o_style){\n      switch(tilesProvider){\n        case 'maptiler':\n          if(o_style == 'basic-v2' ||\n              o_style == 'basic-4326' ||\n              o_style == 'bright-v2' ||\n              o_style == 'openstreetmap' ||\n              o_style == 'outdoor' ||\n              o_style == 'pastel' ||\n              o_style == 'hybrid' ||\n              o_style == 'streets-v2' ||\n              o_style == 'toner' ||\n              o_style == 'topo' ||\n              o_style == 'topographique' ||\n              o_style == 'voyager' ||\n              o_style == 'winter' ) {\n              currentStyle = o_style;\n          } else {\n            console.log(\"Unknown style\", o_style);\n          }\n          break;\n        case 'mapbox':\n            if(o_style === 'mapbox/streets-v11' ||\n                o_style === 'mapbox/outdoors-v11' ||\n                o_style === 'mapbox/light-v10' ||\n                o_style === 'mapbox/dark-v10' ||\n                o_style === 'mapbox/satellite-v9' ||\n                o_style === 'mapbox/satellite-streets-v11' ||\n                o_style === 'mapbox/navigation-day-v1' ||\n                o_style === 'mapbox/streets-v11' ||\n                o_style === 'mapbox/navigation-night-v1') {\n                currentStyle = o_style;\n            }\n            else {\n              console.log(\"Unknown style\", o_style);\n            }\n            break;\n        case 'thunderforest':\n            if(o_style === 'cycle' ||\n                o_style === 'transport' ||\n                o_style === 'landscape' ||\n                o_style === 'outdoors' ||\n                o_style === 'transport-dark9' ||\n                o_style === 'spinal-map' ||\n                o_style === 'pioneer' ||\n                o_style === 'mobile-atlas' ||\n                o_style === 'neighbourhood' ||\n                o_style === 'atlas') {\n                currentStyle = o_style;\n            }\n            else {\n              console.log(\"Unknown style\", o_style);\n            }\n            break;\n      }\n  }\n\n    switch(tilesProvider){\n        case \"mapbox\":\n          type = 'gl';\n          currentKey = app.forum.attribute(\"mapbox.key\")||'';\n          currentStyle = currentStyle || app.forum.attribute(\"mapbox.style\")||'mapbox/light-v9';\n          tileLayerURL = 'mapbox://styles/'+currentStyle;\n          attribution = '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>, ' +\n          '© <a href=\"https://www.mapbox.com/\">Mapbox</a>';\n          break;\n        case \"thunderforest\":\n          type: 'gl';\n          currentKey = app.forum.attribute(\"thunderforest.key\")||'';\n          currentStyle = currentStyle || app.forum.attribute(\"thunderforest.style\")||'atlas';\n          tileLayerURL = 'https://tile.thunderforest.com/{id}/{z}/{x}/{y}.png?apikey={key}';\n          attribution = '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>, ' +\n          '© <a href=\"https://www.thunderforest.com/\">Thunderforest</a>';\n          break;\n        case \"maptiler\":\n          type = 'gl';\n          currentKey = app.forum.attribute(\"maptiler.key\")||'';\n          currentStyle = currentStyle || app.forum.attribute(\"maptiler.style\")||'basic-v2';\n          tileLayerURL = 'https://api.maptiler.com/maps/'+currentStyle+'/style.json?key='+currentKey;\n          attribution = \"\\u003ca href=\\\"https://www.maptiler.com/copyright/\\\" target=\\\"_blank\\\"\\u003e\\u0026copy; MapTiler\\u003c/a\\u003e \\u003ca href=\\\"https://www.openstreetmap.org/copyright\\\" target=\\\"_blank\\\"\\u003e\\u0026copy; OpenStreetMap contributors\\u003c/a\\u003e\";\n          break;\n        default:\n          tileLayerURL = 'https://tile.openstreetmap.org/{z}/{x}/{y}.png';\n          attribution = '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>';\n    }\n\n\n    if(o_zoom){\n      zoom = o_zoom;\n    }\n    if(zoom < 0 || zoom > 18){\n        zoom = 13;\n    }\n    return {\"tilesProvider\": tilesProvider, \"attribution\": attribution,\"currentStyle\":\n                currentStyle, \"currentKey\": currentKey, \"tileLayerURL\": tileLayerURL,\n                \"zoom\": zoom, maxZoom: 18, tileSize: 512, zoomOffset: -1, detectRetina: true,\n                defaultLocation: [51.505, -0.09], \"type\": type };\n  };\n\nexport function getTileLayer(mapConf){\n  //console.log(mapConf);\n  if(mapConf && mapConf.tilesProvider){\n    // Allow SVG tiles from 'gl' providers (MapTiler for instance)\n    if(mapConf.type === 'gl'){\n      return new L.mapboxGL({\n        attribution: mapConf.attribution,\n        accessToken: mapConf.currentKey,\n        style: mapConf.tileLayerURL\n      });\n    } else {\n      // Raster tiles\n      return new L.tileLayer(mapConf.tileLayerURL,\n        {\n          key: mapConf.currentKey,\n          maxZoom: mapConf.maxZoom,\n          attribution: mapConf.attribution,\n          id: mapConf.currentStyle,\n          tileSize: mapConf.tileSize,\n          zoomOffset: mapConf.zoomOffset,\n          detectRetina: mapConf.detectRetina\n        });\n    }\n  }\n};\n\n\nexport function createMap(pid) {\n  let so = {};\n  so.postId = pid;\n  so.mapConf = getMapConfig();\n\n  //for each gpx file in this post, loop and map\n  $('div.PostStream-item[data-id=\"'+pid+'\"] .mapFile-container').each(function( i ) {\n\n    // grab the uploaded gpx file's UUID and url\n    let uuid = $(this).children('.mapFile').data('fofUploadDownloadUuid');\n    let nid = 'map-'+so.postId+i+'-'+uuid;\n    let url = app.forum.attribute('apiUrl') + '/fof/download';\n            url += '/' + uuid;\n            url += '/' + so.postId;\n            url += '/' + app.session.csrfToken;\n\n    let fileExt = $(this).children('.mapFile').data('mapUrl').split('.').pop().toLowerCase();\n\n    /*  change the template rendering to insert a new id to the map element.\n      * this allows us to have an unique div id even if a same file is displayed\n      * more than one time\n    */\n    $(this).children('.mapFile-placeholder').prop('id', nid);\n\n    // Get the map element\n    let map = L.map(nid);\n    map.addControl(new L.Control.Fullscreen());\n\n    // Set the tiles provider\n    getTileLayer(so.mapConf).addTo(map);\n\n    if(fileExt == 'gpx'){\n    // Display the GPX file in it thanks to https://github.com/mpetazzoni/leaflet-gpx\n    new L.GPX(url,\n        {\n          async: true,\n          marker_options: {\n            startIconUrl: '/assets/extensions/jeromegillard-map/pin-icon-start.png',\n            endIconUrl: '/assets/extensions/jeromegillard-map/pin-icon-end.png',\n            shadowUrl: '/assets/extensions/jeromegillard-map/pin-shadow.png',\n            wptIconUrls: {\n              '': '/assets/extensions/jeromegillard-map/default-waypoint.png',\n              'Geocache Found': '/assets/extensions/jeromegillard-map/geocache.png',\n              'Park': '/assets/extensions/jeromegillard-map/tree.png'\n            },\n          }\n        }\n      ).on('loaded', function(e) {\n      map.fitBounds(e.target.getBounds());\n      }).addTo(map);\n    }\n\n    else if(fileExt === 'json' || fileExt === 'geojson'){\n      fetch(url)\n        .then(response => response.json())\n        .then(json => {\n\n          function onEachFeature(feature, layer) {\n\n            if(feature && feature.properties){\n              var popupContent = '';\n\n              if (feature.properties.name) {\n                popupContent += feature.properties.name;\n              }\n              if (feature.properties.description) {\n                popupContent += feature.properties.description;\n              }\n\n              if (feature.properties.amenity === 'parking') {\n                // Check if feature is a polygon\n                if (feature.geometry.type === 'Polygon') {\n                  // Prepare a parking icon\n                  var parkingIcon = L.icon({\n                    iconUrl: '/assets/extensions/jeromegillard-map/pin-icon-parking.png',\n                    iconSize: [20, 20],\n                    iconAnchor: [10, 20],\n                    popupAnchor: [0, -10]\n                  });\n                  // Get bounds of polygon\n                  var bounds = layer.getBounds();\n                  // Get center of bounds\n                  var center = bounds.getCenter();\n                  // Use center to put marker on map\n                  var marker = L.marker(center,\n                    {icon: parkingIcon}\n                    ).addTo(map);\n                  }\n              }\n\n              if(popupContent !== ''){\n                layer.bindPopup(popupContent);\n              }\n            }\n          }\n\n          var geoJSONLayer = L.geoJSON([json], {\n            style: function (feature) {\n              if( feature.properties && feature.properties.colour){\n                return {\n                  color: feature.properties.colour,\n                  weight: 3,\n                  opacity: 1\n                  };\n              }\n            },\n            onEachFeature: onEachFeature,\n          }).addTo(map);\n          map.fitBounds(geoJSONLayer.getBounds());\n          });\n    }\n\n    else {\n      map.setView(so.mapConf.defaultLocation, so.mapConf.zoom);\n    }\n\n  });\n\n  // for each map location from BBCode, loop and map\n  $('div.PostStream-item[data-id=\"'+pid+'\"] .bbcode-map').each(function( i ) {\n    let location = $(this).data('mapLocation');\n    var title = $(this).data('mapTitle');\n    var desc = $(this).data('mapDesc');\n    let mapConf = getMapConfig(\n      $(this).data('mapProvider'),\n      $(this).data('mapStyle'),\n      $(this).data('mapZoom')\n    )\n    //console.log(mapConf, $(this).data('mapStyle'));\n    const nid = 'map-'+Math.floor(Math.random() * 1000);\n    $(this).prop('id', nid);\n\n    if(location){\n      // resolve location as coordinates\n      fetch(`https://nominatim.openstreetmap.org/search?q=${location}&format=json`)\n        .then(response => response.json())\n        .then(json => {\n\n          // Get the map element\n          let map = L.map(nid);\n          map.addControl(new L.Control.Fullscreen());\n          // Set the tiles provider\n          getTileLayer(mapConf).addTo(map);\n          map.setView([json[0].lat, json[0].lon], mapConf.zoom);\n          //create marker and assign to map.\n\n          let pIcon = L.icon({\n            iconUrl: '/assets/extensions/jeromegillard-map/pin-icon-start.png',\n            iconSize: [33, 45],\n            iconAnchor: [16, 45],\n            popupAnchor: [0, -22]\n          });\n\n          let popupContent = '';\n\n          if (title) {\n            popupContent += '<strong>'+title+'</strong>';\n          }\n          if (desc) {\n            popupContent += '<br/>'+desc;\n          }\n\n          // put marker on map\n          let marker = L.marker([json[0].lat, json[0].lon], { icon: pIcon }).addTo(map);\n          if(popupContent){\n            marker.bindPopup(popupContent).openPopup();\n          }\n\n        });\n    }\n  });\n};\n","import app from 'flarum/forum/app';\nimport Post from 'flarum/components/Post';\nimport Page from 'flarum/components/Page';\nimport { extend } from 'flarum/common/extend';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport TextEditorButton from 'flarum/common/components/TextEditorButton';\nimport mapFile from './components/mapFile';\nimport insertAtCursor from './components/mapBBCode';\nimport { createMap, getMapConfig, getTileLayer } from './components/mapConfigHelper';\n\napp.initializers.add('jeromegillard/osm', () => {\n  app.store.models.files = mapFile;\n\n  extend(TextEditor.prototype, 'toolbarItems', function (items) {\n    let mapConf = getMapConfig();\n    items.add(\n      'bbcode',\n      <TextEditorButton onclick={() => insertAtCursor(mapConf.tilesProvider, mapConf.currentStyle, mapConf.zoom)} icon={'fas fa-map'}>\n        {app.translator.trans('jeromegillard-map.forum.text_editor.bbcode_tooltip')}\n      </TextEditorButton>\n    );\n  });\n\n});\n\n// Render maps in posts\nextend(Post.prototype, 'oncreate', function(){\n  createMap(this.attrs.post.id());\n});\n\n// Render maps in pages (fof/pages)\nextend(Page.prototype, 'oncreate', function(){\n  const pid = this.attrs.id;\n  if(this.attrs.routeName === 'page'){\n    // Wait for the post to be rendered. Anyone has a better event?\n    // With fof/links, when a user browse from a post to the page, there's no event triggered\n    setTimeout(createMap, 500, pid);\n  }\n});\n","export default function insertAtCursor(tilesProvider, style, zoom) {\n\n  (async () => {\n\n    let input = document.querySelector('textarea.FormControl');\n\n    let pos = input.selectionStart\n    let front = (input.value).substring(0, pos);\n    let back = (input.value).substring(pos, input.value.length);\n    let middle = `[map provider=${tilesProvider??'osm'} style=${style??'street'} zoom=${zoom??13}]${app.translator.trans('jeromegillard-map.forum.text_editor.location_placeholder')}[/map]`;\n\n    input.value = front+middle+back;\n    pos = pos + 1;\n\n    input.selectionStart = pos;\n      input.selectionEnd = pos;\n      input.focus();\n\n    })()\n\n}\n"],"names":["_typeof","require","_regeneratorRuntime","module","exports","__esModule","Op","Object","prototype","hasOwn","hasOwnProperty","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","obj","key","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","state","method","arg","Error","undefined","done","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","type","fn","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","invoke","resolve","reject","result","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","doneResult","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","o","get","prop","r","flarum","core","compat","app","console","log","_setPrototypeOf","p","bind","mapFile","subClass","superClass","apiEndpoint","exists","data","id","bbcode","tag","uuid","humanSize","url","baseName","mixin","Model","path","size","createdAt","hidden","asyncGeneratorStep","gen","_next","_throw","getMapConfig","o_tilesProvider","o_style","o_zoom","currentStyle","currentKey","tileLayerURL","attribution","tilesProvider","zoom","maxZoom","tileSize","zoomOffset","detectRetina","defaultLocation","getTileLayer","mapConf","L","mapboxGL","accessToken","style","tileLayer","createMap","pid","so","postId","$","each","children","nid","fileExt","split","toLowerCase","map","addControl","Control","Fullscreen","addTo","GPX","marker_options","startIconUrl","endIconUrl","shadowUrl","wptIconUrls","on","e","fitBounds","target","getBounds","fetch","response","json","geoJSONLayer","geoJSON","feature","properties","colour","color","weight","opacity","onEachFeature","layer","popupContent","description","amenity","geometry","parkingIcon","icon","iconUrl","iconSize","iconAnchor","popupAnchor","center","getCenter","marker","bindPopup","setView","location","title","desc","Math","floor","random","lat","lon","pIcon","openPopup","extend","TextEditor","items","add","onclick","input","document","querySelector","pos","selectionStart","front","substring","back","middle","translator","trans","selectionEnd","focus","args","arguments","apply","Post","attrs","post","Page","routeName","setTimeout"],"sourceRoot":""}